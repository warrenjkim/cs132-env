#!/bin/bash

CONTAINER_NAME=cs132-env
CMD=$(echo $1 | tr '[:upper:]' '[:lower:]')
HW=$2

if [[ "$CMD" == "start" ]]; then
    (cd "$CS132_ENV_BIN_DIR/docker" && docker compose up -d)

elif [[ "$CMD" == "stop" ]]; then
    (cd "$CS132_ENV_BIN_DIR/docker" && docker compose down -v -t 0)

elif [[ "$CMD" == "remove" ]]; then
    (cd "$CS132_ENV_BIN_DIR/docker" && docker compose down -v -t 0)
    echo "Removing $CS132_ENV_BIN_DIR from \$PATH..."
    export PATH="$CS132_ENV_OLD_PATH"
    echo "\$PATH is now $PATH"

else
    (cd "$CS132_ENV_BIN_DIR/docker" && docker compose exec $CONTAINER_NAME bash -c "gradle --version")
    echo
    (cd "$CS132_ENV_BIN_DIR/docker" && docker compose exec $CONTAINER_NAME bash -c "cd ./${HW} && gradle ${CMD}")
fi
